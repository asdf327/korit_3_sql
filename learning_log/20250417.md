# ì…ì‹¤ ì²´í¬ í•´ì£¼ì„¸ìš” !! ğŸ¥—

## `IS NULL`
- SQL ìƒì—ì„œ ê°’ì´ ì¡´ì¬í•˜ì§€ ì•ŠìŒ(ë¹„ì–´ ìˆìŒ)ì„ í™•ì¸í•˜ëŠ” ì¡°ê±´ë¬¸.

-> `IS NOT NULL` - NULL ê°’ì´ ì•„ë‹Œ ê²ƒë§Œ ë³´ê³  ì‹¶ì„ ë•Œ.
* ì£¼ì˜ ì‚¬í•­
- `NULL`ì€ ë¹„ì–´ìˆìŒì— í•´ë‹¹í•˜ì§€ 0ì´ë‚˜ ë¬¸ìì—´ì´ ì•„ë‹ˆë‹¤.

í˜„ì¬ê¹Œì§€ ì‘ì„±í•œ SQL í¸ì§‘ê¸°
```sql
-- í…Œì´ë¸” ìƒì„±
-- 1. 
CREATE TABLE student (
	student_id INT PRIMARY KEY,
	student_name VARCHAR(100),
	department VARCHAR(100),
	admission_year INT
);

SELECT * FROM student;

-- 2.
CREATE TABLE subject (
	subject_id INT PRIMARY KEY,
	subject_name VARCHAR(100),
	credit INT
);

SELECT * FROM subject;

-- 3.
CREATE TABLE score (
	student_id INT,
	subject_id INT,
	grade INT,
	FOREIGN KEY (student_id) REFERENCES student(student_id),
	FOREIGN KEY (subject_id) REFERENCES subject(subject_id)
);
SELECT * FROM score;

-- í•™ìƒ ë°ì´í„°
INSERT INTO student VALUES
(1, 'ê¹€ì˜í¬', 'ì»´í“¨í„°ê³µí•™ê³¼', 2021),
(2, 'ì´ì² ìˆ˜', 'ì „ìê³µí•™ê³¼', 2020),
(3, 'ë°•ë¯¼ìˆ˜', 'ê¸°ê³„ê³µí•™ê³¼', 2022),
(4, 'ìµœìˆ˜ì•„', 'ì»´í“¨í„°ê³µí•™ê³¼', 2021);

-- ê³¼ëª© ë°ì´í„°
INSERT INTO subject VALUES
(101, 'ë°ì´í„°ë² ì´ìŠ¤', 3),
(102, 'ìš´ì˜ì²´ì œ', 3),
(103, 'ì»´í“¨í„°ë„¤íŠ¸ì›Œí¬', 2),
(104, 'ì•Œê³ ë¦¬ì¦˜', 3);

-- ì„±ì  ë°ì´í„°
INSERT INTO score VALUES
(1, 101, 85),
(1, 102, 90),
(2, 101, 78),
(2, 103, 88),
(3, 104, 92),
(4, 101, 95),
(4, 102, 82);

```

# ì„œë¸Œì¿¼ë¦¬ 

# ì •ì˜
- ì¿¼ì¿¼ë¦¬ ë‚´ë¶€ì˜ ì¿¼ë¦¬ -> SELECT ë¬¸ ë‚´ë¶€ì— ìˆëŠ” SELECT ë¬¸
- í•˜í•˜ë‚˜ì˜ ë©”ì¸ ì¿¼ë¦¬ë¥¼ ë³´ì¡°í•˜ê¸° ìœ„í•´ã…” ì¤‘ê°„ ê³„ì‚°ì´ë‚˜ ì¡°ê±´ìœ¼ë¡œ ì‚¬ìš©ë˜ëŠ” SELECT ë¬¸ìœ¼ë¡œì„œ, í•­ìƒ ì„œë¸Œì¿¼ë¦¬ëŠ” ì†Œê´„í˜¸()ë¡œ ê°ì‹¸ì„œ ì‚¬ìš©í•˜ì—¬ ê·¸ ë²”ìœ„ë¥¼ ë‚˜íƒ€ë‚´ëŠ”ë°, ë©”ì¸ì¿¼ë¦¬ì— ë°ì´í„°ë¥¼ ì œê³µí•˜ê±°ë‚˜ ì¡°ê±´ì„ ì§€ì •í•˜ëŠ” ì—­í• .

## ë¹„ìœ  
"ì „ì²´ í‰ê· ë³´ë‹¤ ë†’ì€ ì„±ì ì„ ê°€ì§„ í•™ìƒì„ ì¶”ì¶œí•˜ì‹œì˜¤"ë¼ëŠ” ë¬¸ì œê°€ ìˆì„ ë•Œ, ë¨¼ì € ì „ì²´ í‰ê· ì„ êµ¬í•˜ê³ , ê·¸ í›„ì— í‰ê·  ì´ìƒì¸ ì• ë“¤ì„ ì¶”ì¶œ

## ì„œë¸Œ ì¿¼ë¦¬ì˜ ì‚¬ìš© ì´ìœ  
1. ë³µì¡í•œ ì¡°ê±´ í‘œí˜„ 
 - WHERE  ì ˆë§Œìœ¼ë¡œ í‘œê¸°í•˜ê¸° í˜ë“  ê²½ìš°ì— ì‚¬ìš©
2. ë™ì  í•„í„°ë§ 
  - ì¿¼ë¦¬ ì‹¤í–‰ ì‹œì ì— ê³„ì‚°ë˜ëŠ” ê°’ ê¸°ì¤€ìœ¼ë¡œ ë¹„êµ
3. ê°€ë…ì„± í–¥ìƒ 
  - ê³„ì‚° ê³¼ì •ì„ ì¿¼ë¦¬ ì•ˆì— ëª…í™•íˆ êµ¬ë¶„ ê°€ëŠ¥ 

## ì„œë¸Œì¿¼ë¦¬ì˜ ì¢…ë¥˜ 
- ì„œë¸Œì¿¼ë¦¬ëŠ” ìœ„ì¹˜ì— ë”°ë¼ì„œ ì—­í• ê³¼ í˜•íƒœê°€ ë‹¬ë¼ì§ 
1. ìŠ¤ì¹¼ë¼ ì„œë¸Œì¿¼ë¦¬ - SELECT ì ˆë‚´ì— ()ê°€ ìˆë‹¤ë©´ í•´ë‹¹

```sql

SELECT 
  student_name,                               -- ì»¬ëŸ¼1
  (SELECT AVG(grade) from score) as avg_all   -- ì»¬ëŸ¼2
FROM student;

```
- ëª¨ë“  í•™ìƒ ì˜†ì— ì „ì²´ í‰êµ°ì„ í‘œì‹œ(ê·¸ ê°’ì€ ì „ë¶€ ë™ì¼)

2. ì¸ë¼ì¸ ë·° - FROM ì ˆì— ì‚¬ìš©

```sql

SELECT *
FROM (
  SELECT student_id, AVG(grade) AS avg_grade
  FROM score
  GROUP BY student_id
) AS sub;

```
- sub ë¼ê³  ì´ë¦„ì´ ë¶™ì—¬ì§„ ê°€ìƒ í…Œì´ë¸”(ì €í¬ê°€ ì •ì˜í•˜ì§€ ì•Šì•˜ê¸° ë•Œë¬¸ì—)ì—ì„œ ë°ì´í„°ë¥¼ ì¶”ì¶œí•˜ëŠ” ê²ƒì´ ê°€ëŠ¥.

3. ì¡°ê±´ ë¹„êµ ì„œë¸Œì¿¼ë¦¬ = WHEREì ˆì— ì‚¬ìš© 
- íŠ¹ì • ì¡°ê±´ì„ ë¹„êµí•˜ê±°ë‚˜ ì¡´ì¬ ì—¬ë¶€ë¥¼ íŒë‹¨í•  ë•Œ ì‚¬ìš© 

```sql

SELECT student_name
  FROM student
  WHERE student_id IN (
    SELECT student_id
    FROM score
    WHERE grade > 90
  );

```
- ì„±ì ì´ 90ì  ì´ˆê³¼ì¸ í•™ìƒì˜ ì´ë¦„ë§Œ ì¡°íšŒ 

4. ê·¸ë£¹ ì¡°ê±´ì—ì„œ ë™ì  ê¸°ì¤€ì„ ì ìš© - HAVING ì ˆì— ì‚¬ìš©

```sql

SELECT student_id, AVG(grade) AS avg_score
  FROM score
  GROUP BY student_id
  HAVING AVG(grade) > (
    SELECT AVG(grade) FROM score
  );

```
- í‰ê· ë³´ë‹¤ ë†’ì€ ì ìˆ˜ë¥¼ ì§€ë‹Œ í•™ìƒì˜ student_idë§Œ ì¶œë ¥

# ì„œë¸Œì¿¼ë¦¬ì˜ ê²°ê³¼ê°’(ë°˜í™˜)
- ì„œë¸Œì¿¼ë¦¬ëŠ” ë°˜í™˜í•˜ëŠ” ê²°ê³¼ì˜ í˜•íƒœì— ë”°ë¼ êµ¬ë¶„ì´ ì´ë£¨ì–´ì§.
1. ìŠ¤ì¹¼ë¼ ì„œë¸Œì¿¼ë¦¬

  - ë”± í•˜ë‚˜ì˜ ê²°ê³¼ê°’ì„ ë°˜í™˜í•˜ëŠ” ì„œë¸Œì¿¼ë¦¬

```sql

SELECT student_name
  FROM student
  WHERE admission_year = (
    SELECT MIN(admission_year) FROM student
  );

```

- ì…í•™ë…„ë„ê°€ ê°€ì¥ ë¹ ë¥¸ í•™ìƒì˜ ì´ë¦„ ì¶œë ¥ 

2. ë‹¤ì¤‘ í–‰ / ë‹¨ì¼ ì—´ ì„œë¸Œì¿¼ë¦¬(IN,ANY,ALL í‚¤ì›Œë“œì™€ í•¨ê»˜ ì‚¬ìš©ë˜ëŠ” í¸)

```sql

SELECT student_name
FROM student
WHERE student_id IN (
  SELECT student_id FROM score WHERE grade >= 90
);

```

- ì ìˆ˜ê°€ 90ì  ì´ìƒì¸ í•™ìƒë“¤ì˜ 'ì´ë¦„'ë§Œ ì¶œë ¥

3. ë‹¤ì¤‘ í–‰ & ë‹¤ì¤‘ ì—´ ì„œë¸Œì¿¼ë¦¬(ë³´í†µ EXISTS, INí‚¤ì›Œë“œì™€ í•¨ê»˜ ì‚¬ìš©ë˜ëŠ” í¸)

```sql

SELECT student_name
FROM student
WHERE student_id IN (
  SELECT student_id FROM score WHERE grade >= 90
);

```

- ì ìˆ˜ê°€ 90ì  ì´ìƒì¸ ê³¼ëª©ì´ í•˜ë‚˜ë¼ë„ ì¡´ì¬í•˜ëŠ” í•™ìƒ ì´ë¦„ì„ ì¶œë ¥

## ì„œë¸Œ ì¿¼ë¦¬ vs JOIN 
- ì„œë¸Œì¿¼ë¦¬ 
  - ëª©ì  : ì¡°ê±´ ê³„ì‚°, ì¤‘ê°„ê°’ ë¹„êµ 
  - ìœ„ì¹˜ : SELECT / WHERE / HAVING / FROM
  - ì‚¬ìš© ì˜ˆì‹œ - "í‰ê· ë³´ë‹¤ ë†’ì€" ë“±ì˜ ë¹„êµ ê³„ì‚°ì—ì„œ í™œìš© 

- JOIN
  - ëª©ì  : ë°ì´í„° í…Œì´ë¸”ì„ ì—°ê²°
  - ìœ„ì¹˜ : FROM (ê¸°ë³¸ í…Œì´ë¸”ì„ ë² ì´ìŠ¤ë¡œ ì¢Œì¸¡ì— ë¶™ì´ëŠ” ê°œë…ìœ¼ë¡œ ì €í¬ëŠ” LEFT OUTER JOIN í™œìš©)
  - ì‚¬ìš© ì˜ˆì‹œ : Aí…Œì´ë¸”ê³¼ Bí…Œì´ë¸”ì„ ë¬¶ì–´ì„œ ì¶œë ¥

## ì„œë¸Œ ì¿¼ë¦¬ ì‚¬ìš© ì‹œì˜ ì£¼ì˜ì‚¬í•­ 
1. ì„œë¸Œì¿¼ë¦¬ì˜ ì—°ì‚° ê²°ê³¼ê°€ ë„ˆë¬´ ë§ìœ¼ë©´ ì¡°ê±´ì—ì„œ ì˜¤ë¥˜ ê°€ëŠ¥ì„±ì´ ë†’ìŒ 
2. = ì—°ì‚°ìëŠ” ìŠ¤ì¹¼ë¼ ë­ë¦¬(ê²°ê³¼ê°’ì´ í•˜ë‚˜)ì—ë§Œ ì‚¬ìš© ê°€ëŠ¥
  - ë‹¤ì¤‘ í–‰ì´ ë³€í™˜ë˜ëŠ” ê²½ìš°ì— ì˜¤ë¥˜ ë°œìƒ 
3. í…Œì´ë¸” ë³„ì¹­ì„ ê¼­ ì •í•˜ì…”ì•¼ í•©ë‹ˆë‹¤.  ì ˆì—ì„œ ì„œë¸Œì¿¼ë¦¬ê°€ ëë‚˜ë©´ ë¶™ì—¬ì„œ ì„ì‹œ í…Œì´ë¸” ì´ë¦„ì„ ì •í•´ì•¼ ì˜¤ë¥˜ê°€ ë°œìƒí•˜ì§€ ì•ŠìŒ 

```sql

-- 1. ì „ì²´í•™ìƒ ì¤‘ ì»´í‘¸í„°ê³µí•™ê³ ì˜ í‰ê·  ì„±ì ë³´ë‹¤ ë†’ì€ í•™ìƒì˜ id ì´ë¦„ íƒ–ê¸° 

SELECT s.student_id, s.student_name
FROM student s
WHERE s.student_id IN (
    SELECT sc.student_id
    FROM score sc
    GROUP BY sc.student_id
    HAVING AVG(sc.grade) > (
        SELECT AVG(sc2.grade)
        FROM score sc2
        LEFT JOIN student st2 ON sc2.student_id = st2.student_id
        WHERE st2.department = 'ì»´í“¨í„°ê³µí•™ê³¼'
    )
);
-- ì„œë¸Œì¿¼ë¦¬2ëŠ” ì»´í‘¸í„° ê³µí•™ê³¼ í•™ìƒì˜ í‰ê·  ì„±ì ì„ ì‚°ì¶œí•¨ 
-- ì„œë¸Œì¿¼ë¦¬1ì„ í¬í•¨í•œ ë©”ì¸ì¿¼ë¦¬ëŠ” ì„œë¸Œì¿¼ë¦¬2ì˜ ê²°ê³¼ê°’ì„ ì´ˆê³¼í•œ í•™ìƒë“¤ì˜ id ì´ë¦„ì„ ì¶œë ¥í•¨

-- í‰ê·  ì„±ë²…ë³´ë‹¤ ë†’ì€ ì ìˆ˜ë¥¼ ë°›ì€ í•™ìƒì˜ ì´ë¦„ê³¼ ì ìˆ˜ 
SELECT s.student_name
	FROM student s
	LEFT JOIN score sc ON s.student_id = sc.student_id
	WHERE sc.grade > (
		SELECT AVG(grade) FROM score
	);

-- ì•Œê³ ë¦¬ì¦˜ ê³¼ëª©ì˜ student_idë¥¼ êµ¬í•´ì„œ ì•Œê³ ë¦¬ì¦˜ ê³¼ëª©ì„ ìˆ˜ê°•í•­ í•™ìƒë“¤ì˜ id ì°¾ê¸° 
SELECT student_id
	FROM score
	WHERE student_id = (
		SELECT student_id 
		FROM student 
		WHERE student_name = 'ì•Œê³ ë¦¬ì¦˜'
	);

-- ì»´í“¨í„° ê³µí•™ê³¼ í•™ìƒë“¤ì˜ í‰ê·  ì„±ì ì„ ê³„ì‚° 
	SELECT * FROM student;
	SELECT AVG(grade) AS ì»´ê³µí‰ìˆœì„±ì 
	FROM score
	WHERE student_id IN (
		SELECT student_id 
		FROM student 
		WHERE department = 'ì»´í“¨í„°ê³µí•™ê³¼'
	);

-- ì•„ë¬´ ê³¼ëª©ë„ ìˆ˜ê°•í•˜ì§€ ì•Šì€ í•™ìƒì˜ ì´ë¦„ ì¡°íšŒ

-- í•™ìƒ ë°ì´í„° ì„ì˜ ì‚½ì…
INSERT INTO student VALUES
(5, 'ê¹€ì˜¤', 'ì˜ì–´êµìœ¡ê³¼', 2023);

SELECT student_name
FROM student
WHERE student_id NOT IN (
	SELECT student_id FROM score
);

-- ìš´ì˜ì²´ì œ ê³¼ëª©ì„ ìˆ˜ê°•í•œ í•™ìƒ ì¤‘ì—ì„œ ìµœê³  ì ìˆ˜ë¥¼ ì¶œë ¥ ì»¬ëŸ¼ëª…ì€ ìµœê³  ì ìˆ˜ 
SELECT MAX(grade) AS ìš´ì˜ì²´ì œìµœê³ ì„±ì 
FROM score
WHERE subject_id IN  (
	SELECT subject_id 
	FROM subject 
	WHERE subject_name = 'ìš´ì˜ì²´ì œ'
);

-- ìŠ¤ì¹¼ë¼ ì„œë¸Œ ì¿¼ë¦¬ ì˜ˆì œ ë¬¸ì œ 
-- ê° í•™ìƒ ì´ë¦„ê³¼ ì „ì²´ í‰ê·  ì„±ì ì„ í•¨ê»˜ ì¶œë ¥
SELECT student_name,
	(SELECT avg(grade) FROM score) AS ì „ì²´í‰ê· ì„±ì 
FROM student;

```